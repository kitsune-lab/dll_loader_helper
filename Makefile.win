PRIV_DIR = $(MIX_APP_PATH)/priv
NIF_DLL = $(PRIV_DIR)/dll_loader_helper.dll
C_SRC = $(MAKEDIR)\c_src
NIF_SRC = c_src\dll_loader_helper.cpp
CFLAGS = /O2 /EHsc /I"$(C_SRC)"

all: clean $(NIF_DLL)

clean:
	if exist "$(NIF_DLL)" del /Q /F "$(NIF_DLL)"

build: $(NIF_DLL)

$(NIF_DLL):
  @ if not exist "$(PRIV_DIR)" mkdir "$(PRIV_DIR)"
  $(CC) $(CFLAGS) /I"$(ERTS_INCLUDE_DIR)" /LD /MD /Fe$@ $(NIF_SRC)

.PHONY: all clean
